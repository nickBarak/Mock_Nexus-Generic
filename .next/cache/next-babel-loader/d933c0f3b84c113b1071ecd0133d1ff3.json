{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\nicho\\\\Code\\\\Portfolio\\\\mock_nexus\\\\pages\\\\authors\\\\[id]\\\\page\\\\[page].js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { queryDB } from \"../../../../db\";\nimport ArticleDisplay from '../../../../components/ArticleDisplay';\nimport Layout from \"../../../../layouts\";\nexport async function getStaticPaths() {\n  let authors = await queryDB('SELECT id, articles FROM authors'),\n      paths = authors.rows.map(({\n    id,\n    articles\n  }) => new Array(Math.ceil(articles.length / 15)).fill(true).map((_, i) => ({\n    params: {\n      id: String(id),\n      page: String(i + 1)\n    }\n  })));\n  return {\n    paths,\n    fallback: false\n  };\n}\nexport async function getStaticProps({\n  params: {\n    id,\n    page\n  }\n}) {\n  let [author] = await queryDB('SELECT * FROM authors WHERE id = $1', [id]),\n      articles = await queryDB(`SELECT * FROM articles WHERE author = $1 ORDER BY publish_date DESC OFFSET ${(Number(page) - 1) * 15} ROWS FETCH NEXT 15 ROWS ONLY`, [JSON.stringify({\n    \"id\": Number(id),\n    \"name\": author.name\n  })]);\n  return {\n    props: JSON.parse(JSON.stringify({\n      author: author.name,\n      articles,\n      footerData: {\n        page: Number(page),\n        highestPage: Math.ceil(author.articles.length / 15),\n        route: '/authors/' + id\n      }\n    }))\n  };\n}\n\nfunction Author({\n  author,\n  articles,\n  footerData\n}) {\n  return __jsx(Layout, {\n    footerData: footerData,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 9\n    }\n  }, __jsx(ArticleDisplay, {\n    type: \"author-page\",\n    heading: author,\n    articles: articles,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 13\n    }\n  }));\n}\n\nexport default Author;","map":{"version":3,"sources":["C:/Users/nicho/Code/Portfolio/mock_nexus/pages/authors/[id]/page/[page].js"],"names":["queryDB","ArticleDisplay","Layout","getStaticPaths","authors","paths","rows","map","id","articles","Array","Math","ceil","length","fill","_","i","params","String","page","fallback","getStaticProps","author","Number","JSON","stringify","name","props","parse","footerData","highestPage","route","Author"],"mappings":";;;AAAA,SAASA,OAAT,QAAwB,gBAAxB;AACA,OAAOC,cAAP,MAA2B,uCAA3B;AACA,OAAOC,MAAP,MAAmB,qBAAnB;AAEA,OAAO,eAAeC,cAAf,GAAgC;AACnC,MAAIC,OAAO,GAAG,MAAMJ,OAAO,CAAC,kCAAD,CAA3B;AAAA,MACIK,KAAK,GAAGD,OAAO,CAACE,IAAR,CAAaC,GAAb,CAAiB,CAAC;AAACC,IAAAA,EAAD;AAAKC,IAAAA;AAAL,GAAD,KAAoB,IAAIC,KAAJ,CAAUC,IAAI,CAACC,IAAL,CAAUH,QAAQ,CAACI,MAAT,GAAgB,EAA1B,CAAV,EAAyCC,IAAzC,CAA8C,IAA9C,EAAoDP,GAApD,CAAwD,CAACQ,CAAD,EAAIC,CAAJ,MAAW;AAAEC,IAAAA,MAAM,EAAE;AAAET,MAAAA,EAAE,EAAEU,MAAM,CAACV,EAAD,CAAZ;AAAkBW,MAAAA,IAAI,EAAED,MAAM,CAACF,CAAC,GAAC,CAAH;AAA9B;AAAV,GAAX,CAAxD,CAArC,CADZ;AAGA,SAAO;AAAEX,IAAAA,KAAF;AAASe,IAAAA,QAAQ,EAAE;AAAnB,GAAP;AACH;AAED,OAAO,eAAeC,cAAf,CAA8B;AAAEJ,EAAAA,MAAM,EAAE;AAAET,IAAAA,EAAF;AAAMW,IAAAA;AAAN;AAAV,CAA9B,EAAwD;AAC3D,MAAI,CAACG,MAAD,IAAW,MAAMtB,OAAO,CAAC,qCAAD,EAAwC,CAACQ,EAAD,CAAxC,CAA5B;AAAA,MACIC,QAAQ,GAAG,MAAMT,OAAO,CAAE,8EAA6E,CAACuB,MAAM,CAACJ,IAAD,CAAN,GAAa,CAAd,IAAiB,EAAG,+BAAnG,EAAmI,CAACK,IAAI,CAACC,SAAL,CAAe;AAAE,UAAMF,MAAM,CAACf,EAAD,CAAd;AAAoB,YAAQc,MAAM,CAACI;AAAnC,GAAf,CAAD,CAAnI,CAD5B;AAGA,SAAO;AAAEC,IAAAA,KAAK,EAAEH,IAAI,CAACI,KAAL,CAAWJ,IAAI,CAACC,SAAL,CAAe;AAAEH,MAAAA,MAAM,EAAEA,MAAM,CAACI,IAAjB;AAAuBjB,MAAAA,QAAvB;AAAiCoB,MAAAA,UAAU,EAAE;AACnFV,QAAAA,IAAI,EAAEI,MAAM,CAACJ,IAAD,CADuE;AAEnFW,QAAAA,WAAW,EAAEnB,IAAI,CAACC,IAAL,CAAUU,MAAM,CAACb,QAAP,CAAgBI,MAAhB,GAAyB,EAAnC,CAFsE;AAGnFkB,QAAAA,KAAK,EAAE,cAAcvB;AAH8D;AAA7C,KAAf,CAAX;AAAT,GAAP;AAKH;;AAED,SAASwB,MAAT,CAAgB;AAAEV,EAAAA,MAAF;AAAUb,EAAAA,QAAV;AAAoBoB,EAAAA;AAApB,CAAhB,EAAkD;AAC9C,SACI,MAAC,MAAD;AAAQ,IAAA,UAAU,EAAEA,UAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,MAAC,cAAD;AAAgB,IAAA,IAAI,EAAC,aAArB;AAAmC,IAAA,OAAO,EAAEP,MAA5C;AAAoD,IAAA,QAAQ,EAAEb,QAA9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,CADJ;AAKH;;AAED,eAAeuB,MAAf","sourcesContent":["import { queryDB } from \"../../../../db\";\r\nimport ArticleDisplay from '../../../../components/ArticleDisplay';\r\nimport Layout from \"../../../../layouts\";\r\n\r\nexport async function getStaticPaths() {\r\n    let authors = await queryDB('SELECT id, articles FROM authors'),\r\n        paths = authors.rows.map(({id, articles}) => new Array(Math.ceil(articles.length/15)).fill(true).map((_, i) => ({ params: { id: String(id), page: String(i+1) } })));\r\n\r\n    return { paths, fallback: false }\r\n}\r\n\r\nexport async function getStaticProps({ params: { id, page } }) {\r\n    let [author] = await queryDB('SELECT * FROM authors WHERE id = $1', [id]),\r\n        articles = await queryDB(`SELECT * FROM articles WHERE author = $1 ORDER BY publish_date DESC OFFSET ${(Number(page)-1)*15} ROWS FETCH NEXT 15 ROWS ONLY`, [JSON.stringify({ \"id\": Number(id), \"name\": author.name })]);\r\n\r\n    return { props: JSON.parse(JSON.stringify({ author: author.name, articles, footerData: {\r\n        page: Number(page),\r\n        highestPage: Math.ceil(author.articles.length / 15),\r\n        route: '/authors/' + id\r\n    } })) }\r\n}\r\n\r\nfunction Author({ author, articles, footerData }) {\r\n    return (\r\n        <Layout footerData={footerData}>\r\n            <ArticleDisplay type=\"author-page\" heading={author} articles={articles} />\r\n        </Layout>\r\n    )\r\n}\r\n\r\nexport default Author"]},"metadata":{},"sourceType":"module"}