{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport ArticleDisplay from '../../../components/ArticleDisplay';\nimport Layout from \"../../../layouts\";\nimport dynamic from 'next/dynamic';\nexport async function getStaticPaths() {\n  const queryDB = dynamic(async _ => (await import('../../../db')).queryDB, {\n    loadableGenerated: {\n      webpack: () => [require.resolveWeak('../../../db')],\n      modules: ['../../../db']\n    }\n  });\n  let authors = await queryDB('SELECT id, articles FROM authors'),\n      paths = authors.map(({\n    id,\n    articles\n  }) => new Array(Math.ceil(articles / 15)).fill(true).map((_, i) => ({\n    params: {\n      id: String(id),\n      page: String(i + 1)\n    }\n  })));\n  console.log(JSON.stringify(paths));\n  return {\n    paths,\n    fallback: false\n  };\n}\nexport async function getStaticProps({\n  params: {\n    id,\n    page\n  }\n}) {\n  const [queryDB, getCategories] = dynamic(async _ => [(await import('../../../db')).queryDB, (await import('../db')).getCategories], {\n    loadableGenerated: {\n      webpack: () => [require.resolveWeak('../../../db'), require.resolveWeak('../db')],\n      modules: ['../../../db', '../db']\n    }\n  });\n  let [author] = await queryDB('SELECT * FROM authors WHERE id = $1', [id]),\n      articles = await queryDB(\"SELECT * FROM articles WHERE author = $1 ORDER BY publish_date DESC\", [JSON.stringify({\n    \"id\": Number(id),\n    \"name\": author.name\n  })]);\n  return {\n    props: JSON.parse(JSON.stringify({\n      author: author.name,\n      articles,\n      categories: await getCategories(),\n      footerData: {\n        page: Number(page),\n        highestPage: Math.ceil(articles.length / 15),\n        route: '/authors/' + id\n      }\n    }))\n  };\n}\n\nfunction Author({\n  author,\n  articles,\n  categories,\n  footerData\n}) {\n  return __jsx(Layout, {\n    categories: categories\n  }, __jsx(ArticleDisplay, {\n    type: \"author-page\",\n    heading: author,\n    articles: articles,\n    footerData: footerData\n  }));\n}\n\nexport default Author;","map":null,"metadata":{},"sourceType":"module"}