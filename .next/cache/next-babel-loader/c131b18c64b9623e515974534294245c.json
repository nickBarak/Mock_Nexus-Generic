{"ast":null,"code":"import { queryDB } from \"../../db\";\nexport default async function (req, res) {\n  try {\n    const results = await queryDB(`SELECT * FROM\n                (SELECT DISTINCT ON\n                    (id) id,\n                    title,\n                    category,\n                    subcategory,\n                    publish_date,\n                    full_thumbnail,\n                    mobile_thumbnail,\n                    description,\n                    content,\n                    src_url,\n                    author,\n                    related,\n                    comments,\n                    followers\n                FROM articles) x\n                WHERE\n                    LOWER(title) LIKE LOWER('%${req.query.value}%')\n                    OR LOWER(description) LIKE LOWER('%${req.query.value}%')\n                    OR LOWER(category) LIKE LOWER('%${req.query.value}%')\n                    OR LOWER(subcategory) LIKE LOWER('%${req.query.value}%')\n                    OR LOWER(content) LIKE LOWER('%${req.query.value}%')`);\n    const authorArticleIDs = await queryDB(`SELECT articles FROM authors WHERE LOWER(name) LIKE LOWER('%${req.body.value}%')`);\n    const authorResults = await queryDB('SELECT * FROM articles WHERE id = ANY($1)', [authorArticleIDs]); // console.log(JSON.stringify(results));\n\n    res.json(results ? authorResults ? [...results, ...authorResults] : results : authorResults ? authorResults : []);\n    res.end();\n  } catch (e) {\n    console.log(e);\n  }\n}","map":null,"metadata":{},"sourceType":"module"}