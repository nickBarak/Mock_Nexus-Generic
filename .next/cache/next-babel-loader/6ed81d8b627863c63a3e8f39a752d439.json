{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport { queryDB } from '../../../../../db';\nimport ArticleDisplay from '../../../../../components/ArticleDisplay';\nimport Layout from '../../../../../layouts';\nimport { convertToPath, convertFromPath } from '../../../../../Functions';\nexport async function getStaticPaths() {\n  let categories = await queryDB(\"SELECT title, subcategories FROM categories WHERE title <> 'Labyrinth' AND title <> 'Headlines'\"),\n      paths = categories.reduce((acc, category) => [...acc, ...Object.entries(category.subcategories).map(([key, val]) => new Array(Math.ceil(val.length / 15)).fill(true).map((_, i) => ({\n    params: {\n      category: convertToPath(category.title),\n      subcategory: convertToPath(key),\n      page: String(i + 1)\n    }\n  })))], []).reduce((acc, cur) => [...acc, ...cur], []);\n  return {\n    paths,\n    fallback: false\n  };\n}\nexport async function getStaticProps({\n  params: {\n    category,\n    subcategory,\n    page\n  }\n}) {\n  let [subcategories] = await queryDB('SELECT subcategories FROM categories WHERE title = $1', [convertFromPath(category)]),\n      articles = await queryDB(`SELECT * FROM articles WHERE id = ANY($1) ORDER BY publish_date DESC OFFSET ${(Number(page) - 1) * 15} ROWS FETCH NEXT 15 ROWS ONLY`, [subcategories.subcategories[convertFromPath(subcategory)]]);\n  return {\n    props: JSON.parse(JSON.stringify({\n      heading: convertFromPath(subcategory),\n      articles,\n      footerData: {\n        page: Number(page),\n        route: '/categories/' + category + '/' + subcategory,\n        highestPage: Math.ceil(subcategories.subcategories[convertFromPath(subcategory)].length / 15)\n      }\n    }))\n  };\n}\n\nfunction Subcategory({\n  heading,\n  articles,\n  footerData\n}) {\n  return __jsx(Layout, {\n    footerData: footerData\n  }, __jsx(ArticleDisplay, {\n    type: 'subcategory',\n    heading: heading,\n    articles: articles,\n    page: footerData.page\n  }));\n}\n\nexport default Subcategory;","map":null,"metadata":{},"sourceType":"module"}