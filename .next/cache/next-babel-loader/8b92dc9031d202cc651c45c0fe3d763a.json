{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nexport function convertDate(date) {\n  var now = new Date(),\n      secondsPast = (now.getTime() - date) / 1000;\n\n  if (secondsPast < 60) {\n    return parseInt(secondsPast) + \" second\".concat(parseInt(secondsPast) > 1 ? 's' : '', \" ago\");\n  }\n\n  if (secondsPast < 3600) {\n    return parseInt(secondsPast / 60) + \" minute\".concat(parseInt(secondsPast / 60) > 1 ? 's' : '', \" ago\");\n  }\n\n  if (secondsPast <= 86400) {\n    return parseInt(secondsPast / 3600) + \" hour\".concat(parseInt(secondsPast / 3600) > 1 ? 's' : '', \" ago\");\n  }\n\n  return new Date(date).toLocaleDateString('default', {\n    day: 'numeric',\n    month: 'long',\n    year: 'numeric'\n  });\n}\nexport function convertToPath(string) {\n  return string.toLowerCase().replace(/ /g, '-').replace(/[:'!@#$%^&*\\(\\)\";{}\\[\\]\\|~`<>\\/\\\\?\\.,]/g, '');\n}\nexport function convertFromPath(path) {\n  return path.split('-').map(function (word, i) {\n    return i === 0 || !['the', 'on'].includes(word) ? word[0].toUpperCase() + word.slice(1) : word;\n  }).join(' ');\n}\nexport function testEmail(email) {\n  return /(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])/.test(email);\n}\nexport function postComment(_x, _x2, _x3) {\n  return _postComment.apply(this, arguments);\n}\n\nfunction _postComment() {\n  _postComment = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e, setMessage, article_id) {\n    var parent,\n        _map,\n        _map2,\n        content,\n        name,\n        email,\n        response,\n        status,\n        msg,\n        _args = arguments;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            parent = _args.length > 3 && _args[3] !== undefined ? _args[3] : null;\n            e.persist();\n            _map = [0, 1, 2].map(function (i) {\n              return e.target.children[i].children[1].value;\n            }), _map2 = _slicedToArray(_map, 3), content = _map2[0], name = _map2[1], email = _map2[2];\n\n            if (!(!content || !name || !email)) {\n              _context.next = 5;\n              break;\n            }\n\n            return _context.abrupt(\"return\", setMessage('There is an empty field'));\n\n          case 5:\n            _context.next = 7;\n            return fetch('../api/post-comment', {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: JSON.stringify({\n                article_id: article_id,\n                name: name,\n                email: email,\n                content: content,\n                parent: parent,\n                post_date: Date.now()\n              })\n            });\n\n          case 7:\n            response = _context.sent;\n            _context.next = 10;\n            return response.json();\n\n          case 10:\n            status = _context.sent;\n            _context.t0 = status;\n            _context.next = _context.t0 === 0 ? 14 : _context.t0 === 1 ? 16 : _context.t0 === 2 ? 18 : _context.t0 === 3 ? 20 : 22;\n            break;\n\n          case 14:\n            setMessage('');\n            return _context.abrupt(\"break\", 23);\n\n          case 16:\n            msg = 'Invalid email address';\n            return _context.abrupt(\"break\", 23);\n\n          case 18:\n            msg = 'This email is registered with a different name';\n            return _context.abrupt(\"break\", 23);\n\n          case 20:\n            msg = 'New user created';\n            return _context.abrupt(\"break\", 23);\n\n          case 22:\n            console.log(status);\n\n          case 23:\n            msg && setMessage(msg);\n            (!status || status === 3) && !sessionStorage.getItem('email') || sessionStorage.setItem('email', email) || sessionStorage.setItem('name', name);\n            e.target.reset();\n\n          case 26:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _postComment.apply(this, arguments);\n}","map":null,"metadata":{},"sourceType":"module"}